611
РЕАЛИЗАЦИЯ И СРАВНИТЕЛЬНЫЙ АНАЛИЗ МЕТОДОВ МАШИННОГО ОБУЧЕНИЯ ДЛЯ КЛАССИФИКАЦИИ МУЗЫКАЛЬНЫХ КОМПОЗИЦИЙ ПО ЖАНРАМ 
4 Анализ полученных результатов. Сравнение точности линейного и нелинейного классификатора 
----------
По окончании работы алгоритма печатается массив предсказанных жанров и значение точности классификации. Но в многоклассовых задачах важно не только узнать, насколько верно определён жанр произведения, но и выяснить, какие жанры путаются. Для этого можно воспользоваться одной из метрик оценки качества классификации – матрицей неточностей (confusion matrix). В ней содержится распределение меток, предсказанных на тестовом наборе для каждого жанра. На рисунке 7 представлена матрица ошибок для классификации 39 произведений.
Рисунок 7 – матрица неточностей для линейного классификатора
Размер матрицы 6´6, так как в выборке шесть жанров. На диагонали находятся правильные результаты. Первая строка означает, что 6 из 6 классических произведений классифицированы верно, во второй строке 5 файлов жанра hiphop из 7 были распознаны верно, 1 – как классика и 1 – как pop. Итого из 39 произведений 30 были идентифицированы правильно. Точность классификации составляет 76,9%, что является достойным результатом для многоклассовой задачи. Поскольку наглядное представление воспринимается гораздо легче, чем просто напечатанные двумерные массивы nympy, лучше визуализировать матрицу неточностей (рисунок 8).
Рисунок 8 – визуализированная матрица ошибок
В первом случае мы извлекали по 13 коэффициентов из каждого аудиофайла. Попробуем увеличить их количество до 20, тогда на вход классификатору подаётся по 20 MFCC на каждое музыкальное произведение. Это немного увеличивает время обучения, но зато результаты, изображенные на рисунке 9, немного отличаются от предыдущих.
Рисунок 9 – матрица неточностей при количестве MFCC = 20
Не трудно заметить, что для жанра jazz предсказания стали на одну композицию точнее, тогда как в жанре pop увеличилось число неверно распознанных треков. Поэтому в данном случае точность также составляет 76%. Классификатор явно путает жанры pop и hiphop, хотя в реальности даже для человеческого слуха они могут быть неотличимы, а он является самым совершенным идентификатором на данный момент.
Теперь протестируем на том же наборе тестовых и обучающих данных нелинейный классификатор на основе Скрытых Марковских Моделей (СММ) [8]. Аналогично, результаты занесём в матрицу ошибок. Получаем гораздо более точный прогноз для тестовых композиций, представленный на рисунке 10.
Рисунок 10 – результаты классификатора на основе СММ
Показатель точности идентификации составляет уже 82%, хотя алгоритм СММ верно распознал всего на две композиции больше, чем логистическая регрессия, то есть 32 из 39 треков. Коэффициенты в данном алгоритме не усредняются по всем кадрам, соответственно матрица признаков имеет очень большие размеры, ведь нелинейные методы машинного обучения как раз и рассчитаны на большое количество численных описаний объектов. Но стоит отметить, что время обучения и тестирования в данном случае в несколько раз превышает время работы линейного классификатора. Если классификатору на основе логистической регрессии требуется около 5 минут, чтобы обучиться и напечатать результат, то нелинейному классификатору со сложной моделью машинного обучения требуется на это около часа.
Теперь в тестовую выборку включим больше файлов, чтобы её объём был примерно 30% от всего объёма данных. В таких пропорциях обычно разделяют данные в машинном обучении: 30% тестовых и 70% обучающих. В каталоге 175 музыкальных композиций и 20 MFCC в массиве для каждого трека были получены результаты работы линейного классификатора, изображенные на рисунке 11.
Рисунок 11 – результаты работы для 175 аудиофайлов
Теперь верно распознаны 136 из 175 треков и точность составляет 77,7%. Процесс обучения и тестирования классификатора также занимает относительно немного времени – около 15 минут.
На тех же данных классификатор на основе Скрытых Марковских моделей распознал верно 143 из 175 музыкальных произведений, матрица неточностей представлена на рисунке 12.
Рисунок 12 – результаты распознавания композиций нелинейным классификатором
Точность выше 81% является очень хорошим показателем работы алгоритма идентификации.
Можно было бы утверждать, что нелинейный классификатор, который составляет сложные модели для каждого класса, более гибкий с точки зрения точности, чем классификатор на основе логистической регрессии. Но построение подробных моделей отнимает очень много времени: обучение классификатора на основе СММ длилось около 10 часов. Достоинство линейных методов классификации в экономии времени обучения и проверки и в хорошей интерпретации.