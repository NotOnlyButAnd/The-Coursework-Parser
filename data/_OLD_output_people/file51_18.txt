323
ИССЛЕДОВАНИЯ АЛГОРИТМОВ КОЛЛАБОРАТИВНОЙ ФИЛЬТРАЦИИ И РАЗРАБОТКА РАСШИРЯЕМОЙ РЕКОМЕНДАТЕЛЬНОЙ СИСТЕМЫ 
3 Практическая реализация рекомендательной системы с неявной обратной связью через матричную факторизацию 
3.5 Оценивание рекомендательной системы 
----------
При выделении обучающей выборки было скрыто 20% всех покупок. Это позволило оценить эффективность рекомендательной системы. По сути, видно, что предсказанные рекомендации для каждого пользователя совпадают с теми, которые они в конечном итоге купили. Часто используемой метрикой для такого рода проблемы является рабочая характеристика приёмника (или ROC) кривой. Большая площадь под кривой означает, что система рекомендует товары, которые в конечном итоге были приобретены. Как правило, эта метрика используется в более типичных проблемах бинарной классификации, чтобы определить, насколько хорошо модель, может прогнозировать положительный или отрицательный пример. Он также будет хорошо работать для наших целей ранжирования рекомендаций.
Чтобы это сделать, необходимо написать функцию, которая сможет вычислять среднюю площадь под Кривой (AUC) для любого пользователя, у которого взаимодействие хотя бы с одним товаром скрыто. В качестве ориентира вычислим среднюю AUC, то есть рекомендуемая выборка из самых популярных товаров. Популярность обычно является трудно победимым фактором в большинстве рекомендательных систем, поэтому она даёт хорошее сравнение.
Для этих целей создадим простую функцию, которая может вычислить наш AUC (рисунок 14). Пакет scikit-learn имеет подходящую функцию, которую надо немного изменить.
Рисунок 14 – Функция нахождения площади под кривой
Теперь используем эту вспомогательную функцию внутри второй функции, которая будет вычислять значение AUC для каждого пользователя в нашем обучающем наборе, которые имели по крайней мере скрытым по крайней мере одно взаимодействие с товарами (рисунок 15). Следует также рассчитать AUC самых популярных товаров для наших пользователей, чтобы затем сравнить с результатом рекомендаций системы.
Рисунок 15 – Функция вычисления AUC
Чтобы использовать эту функцию, необходимо преобразовать выходные данные из функции ALS в csr_matrix формат и транспонировать вектора товаров. Получение векторов пользователей и элементов в уже нужном формате изображен на рисунке 16.
Рисунок 16 – Получение векторов пользователей и элементов
Здесь видно, что система рекомендаций превысила точность наиболее популярных товаров. У система рекомендаций среднее значение AUC в размере 0,87, в то время как наиболее популярные товары получили более низкий AUC из 0.814. Также не стоит забывать, что это параметризированная модель и при определенных параметрах можно увеличить AUC.