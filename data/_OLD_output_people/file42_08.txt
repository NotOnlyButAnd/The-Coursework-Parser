326
РАЗРАБОТКА ПРОГРАММНОГО АГЕНТА ДЛЯ ИНФОРМАЦИОННОГО ПОИСКА В СРЕДЕ ИНТЕРНЕТ 
2 Парсинг сайта . 
2.3 Библиотека HtmlAgilityPack 
----------
Библиотека HtmlAgilityPack –  это  NET библиотека, которая позволяет
работать с HTML файлами "вне сети".  Это парсер HTML, который поддерживает простой язык запросов к элементам XML (XPath или XSLT) и может строить доступную для чтения  или записи объектную модель документа (DOM).
DOM  [3] ( Document Object Model — объектная модель документа) – это программный интерфейс,   не зависящий от платформы и языка, который позволяет  программам и скриптам получить доступ к содержимому HTML, XHTML и XML-документов, а также изменять оформление, структуру и   содержимое  таких документов.
Любой документ известной структуры с помощью DOM может быть представлен в виде дерева узлов, каждый узел которого представляет собой элемент, атрибут, текстовый, графический или любой другой объект.
XPath (XML Path Language) — язык запросов к элементам XML документа.  XPath   является стандартом консорциума W3C  и разработан для организации доступа к частям документа XML в файлах трансформации XSLT .  Он  призван реализовать навигацию по DOM в XML. В XPath используется компактный синтаксис, отличный от принятого в XML.
Базой языка XPath являются оси. Пример осей: ancestor:: — возвращает множество предков; ancestor-or-self:: — возвращает множество предков и текущий элемент;  attribute:: — возвращает множество атрибутов текущего элемента
(сокращенно - @); descendant-or-self:: — возвращает полное множество потомков и
текущий элемент (сокращенно - //).
Библиотека HtmlAgilityPack позволяет также использовать регулярные выражения для задания шаблонов поиска.
Библиотеку HtmlAgilityPack можно скачать с официального сайта [2].
Для начала работы необходимо открыть  Visual Studio,  создать новый проект на C# и добавить  проект HtmlAgilityPack (вкладка Project – Add Reference – Browse).
В библиотеке HtmlAgilityPack всего доступно двадцать основных
классов. Рассмотрим примеры классов:
HtmlDocument –  создает  полный HTML-документ;
HtmlAtribute – создает Html-атрибуты;
HtmlAtributeCollection  – создает объединенный список и коллекцию атрибутов;
HtmlNode – создает узел Html;
HtmlNodeCollection – создает объединенный список и коллекцию узлов
Html;
HtmlTexNode – создает текстовые узлы Html;
HtmlWeb – вспомогательный класс для получения Html-документа из
Http.
Названия методов соответствуют интерфейсам DOM: GetElementbyId(), CreateAttribute(), CreateElement() и т.д.,
Для работы с библиотекой  HtmlAgilityPack в начале проекта необходимо вставить следующий код:
using HtmlAgilityPack; using HtmlDocument = HtmlAgilityPack.HtmlDocument;