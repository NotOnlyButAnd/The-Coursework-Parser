67
ИЗУЧЕНИЕ ПРИНЦИПОВ ОРГАНИЗАЦИИ АТАК НА AD-HOC СЕТИ И ИХ МОДЕЛИРОВАНИЕ
4 Моделирование атак 
----------
Любой узел, создаваемый в NS2 можно сделать вредоносным. Для этого необходимо при генерации узла добавить следующий код:
$ns at 50.0 "[$node_ (30) set ragent_] malicious"
Для настройки такого узла необходимо добавить некоторые строки в встроенный в NS2 файл с открытым кодом AODV.cc:
#Attack
if ( strcmp(argv[1], “malicious”) ==0) {
malicious=true;
return TCL_OK;
}
//malicious code
if (malicious==true){
drop(p,DROP_RTR_ROUTE_LOOP)
}
Данный код является общим для всех моделируемых атак.