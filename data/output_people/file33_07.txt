666
РЕАЛИЗАЦИЯ И СРАВНИТЕЛЬНЫЙ АНАЛИЗ МЕТОДОВ МАШИННОГО ОБУЧЕНИЯ ДЛЯ КЛАССИФИКАЦИИ МУЗЫКАЛЬНЫХ КОМПОЗИЦИЙ ПО ЖАНРАМ
2 Описание используемых методов, функций и библиотек 
2.1 Извлечение признаков из звуковых файлов 
----------
Так как обучающая выборка строится на основе признаков классифицируемых объектов, то необходимо выделить такие признаки в музыкальных композициях, по которым их можно было бы однозначно отнести к определённому классу. В качестве описаний объектов были выбраны мел-частотные кепстральные коэффициенты (Mel-Frequency Cepstral Coefficients, MFCC).
В задачах распознавания речи и звуковых сигналов часто используется способ кодирования энергетического спектра звука, то есть распределения энергии, содержащейся в частотах, который называется метод мел-частотных кепстральных коэффициентов (MFCC). Эти коэффициенты – спектральные характеристики, уникальные для каждого сигнала. Иначе говоря, это представление энергии сигнала в виде особого спектра, из которого путём различных фильтраций и преобразований удалены незначительные для человеческого уха компоненты и шумы. Спектр проецируется на мел-шкалу. Подобное представление сохраняет волновую «природу» сигнала и позволяет выделить наиболее значимые для человеческого уха частоты.
Вычисление мел-частотных кепстральных коэффициентов включает в себя следующие шаги [6]:
1)  Необходимо разделить исходный сигнал на кадры. Их размер обычно выбирается в диапазоне от 10 до 40 мс. Кадры накладываются друг на друга.
2)  Полагаем, что звуковой сигнал конечен и не является периодическим, поэтому из-за разрывов на его концах, когда применяется преобразование Фурье, может произойти так называемый эффект утечки. В дискретной области так называют эффекты, связанные с искажениями в Фурье анализе, вызванные конечностью выборки. В случае периодического дискретного процесса этих эффектов удается избежать, если специальным образом выбирать шаг дискретизации и длину временного ряда. То есть, можно контролировать «ширину» этой утечки или, концентрируя её вокруг главной частоты (сильно «размывается» спектр, зато не мешает соседним частотам), или, растягивая её на бесконечности (но в этом случае размытие пиков уменьшается, а «шум» сильно растёт и вследствие этого растёт погрешность измерения амплитуды отдельных частот). Как правило, чтобы снизить влияние эффекта утечки на результат, к каждому кадру применяется оконная функция (весовая функция). Часто «конечный» сигнал, используемый для преобразования Фурье, в реальности является частью возможно бесконечного сигнала, такого, как синусоида, например. В этой ситуации применяют дополнение конечного отрезка нулями: считают, что исходный сигнал имеет бесконечно большую длину, но затем умножается на некоторую взвешивающую функцию — «окно», обращающуюся в ноль вне доступного для измерения отрезка. В простейших случаях роль «окна» играет прямоугольная функция, с помощью которой мы, по сути, дополняем отрезок слева и справа бесконечным количеством нулей. В данном случае используем оконную функцию Хемминга:
w(n) = 0.54 – 0.46cos(2)                                    (6)
3)  К каждому кадру применяется преобразование Фурье, получая тем самым спектр сигнала.  Далее вычисляется периодограмма – оценка спектральной плотности мощности сигнала:
Pi (k) = |Yi(k)|2/N                                                      (7)
4)  Полученное представление сигнала в частотной области разбивают на диапазоны с помощью блока треугольных пересекающихся фильтров, расположенных наиболее плотно в области низких частот. Границы фильтров рассчитывают в мел-шкале. Данная шкала является результатом исследований по способности человеческого уха к восприятию звуков на различных частотах. Количество таких фильтров - 26. Для расчёта фильтров обычно выбираются верхняя и нижняя частоты, а затем осуществляется переход от частотной шкалы к мел-шкале по формуле (8):
M(f) = 1127*ln(1+f/700)                                             (8)
5)  Между полученными значениями на мел-шкале выбираются точки, расположенные линейно, как правило, для 26 фильтров — 28 точек. После этого переход обратно в частотную шкалу осуществляется по обратной формуле 9:
F(m) = 700(exp(m/1125) - 1)	                                 (9)
Рисунок 2 – График частотной шкалы
Из графика видно, что окна сжимаются в большей степени в области низких частот (рисунок 2). Далее простым перемножением векторов спектра сигнала и оконной функции находится энергия сигнала, которая попадает в каждое из анализируемых окон. Получаем некоторый набор коэффициентов. Полученные значения энергии сигнала возводятся в квадрат и логарифмируются, после чего применяется дискретное косинусное преобразование. В итоге, у нас есть 26 коэффициентов для каждого кадра (окна) — это и есть мел-частотные кепстральные коэффициенты. В задачах распознавания речи обычно используются первые 13 из них, как наиболее информативные для речевого сигнала.
В результате последовательность коэффициентов выглядит так, как показано на рисунке 3.
Рисунок 3 – График расположения спектральных частотных коэффициентов (MFCC) на мел-шкале
Существуют и другие характеристики звукового сигнала, которые можно было бы взять в качестве признаковых описаний объекта, но для решения задачи классификации по жанрам вектора из мел-частотных кепстральных коэффициентов будет вполне достаточно, чтобы обеспечить высокие показатели точности идентификации, потому что эти значения несут в себе много важной информации об уникальности звукового сигнала.