175
Моделирование трехмерных сцен на основе оптимизированных октодеревьев
3. Реализация октодеревьев на практике 
3.2 Реализация хранения сцены 
----------
Для решения проблемы динамической загрузки и выгрузки из оперативной памяти частей сцены разработана схема его разделения на несколько октодеревьев. Кроме того, такая схема позволяет обойти ограничение октодеревьев – они покрывают только кубическое пространствою. Большая сцена делится на более малые участки размером в  (ширина – высота – длина): куски (Chunk). Они, в свою очередь, поделены на октодеревья размерности 16, представленные классом Octree. Диаграмма классов, описывающая это представлена на рисунке 8.
Для экономии каждый узел октодерева разделяются на внутренние (InnerNode) и листовые (LeafNode). Помимо отличия логики в удалении, установке и иных действиях с данными, различаются типы хранимых данных. Листовые узлы хранят исключительно данные, а промежуточные – лишь ссылки на другие узлы: либо 8 листовых, либо 8 внутренних.
Рисунок 8 – фрагмент диаграммы классов хранения мира
При такой реализации становится возможная динамическая мира для каждого агента. Движок приложения может легко подгружать куски мира необходимые только каждому конкретному агенту на сцене. Определяется кусок, в котором расположен агент и происходит загрузка кусков мира вокруг него. Данный механизм особенно хорошо показывает себя в среде нескольких агентов, расположенных далеко друг от друга.