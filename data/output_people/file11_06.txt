238
ПРИМЕНЕНИЕ МЕТОДОВ ИНТЕЛЛЕКТУАЛЬНОГО АНАЛИЗА ДЛЯ ПРЕДСКАЗАНИЯ РЕЗУЛЬТАТОВ СПОРТИВНЫХ СОРЕВНОВАНИЙ
1 Система сбора и хранения информации 
1.5 Реализация непрерывной работы системы сбора информации 
----------
Так как система работает постоянно, необходимо продумать механизмы планирования задач и распределения нагрузки. Эти механизмы реализованы в библиотеке Celery [1]. Celery – это распределенная асинхронная очередь заданий, которая обладает широким функционалом. Celery умеет:
* выполнять задания асинхронно или синхронно
* выполнять периодические задания
* выполнять отложенные задания
* распределенное выполнение
* в пределах одного worker'а возможно конкурентное выполнение нескольких задач (одновременно)
* выполнять задание повторно, если вылез exception
* ограничивать количество заданий в единицу времени
* routing заданий
* несложно мониторить выполнение заданий
* выполнять подзадания
* присылать отчеты об exception'ах на email
В очереди может быть 4 разных задания. Все задания периодические. Все задания запущены одни и тем же процессом, т.к. необходимо, чтобы они использовали совместные ресурсы (так как выбрана модель сохранения промежуточных данных в оперативную память). Задания выполняются асинхронно.
Первое задание отвечает за обновление  текущих матчей и сбор статистики о матче в промежутке 10-20 минут с начала матча. Статистика записывается в переменную типа словарь, где ключом является id матча. Оно запускается каждые 10 минут.
Второе и третье задания отвечают за добавление к статистике матча количества голов, забитых командами за первый тайм и за всю игру соответственно. Эти задания выполняются 1 раз в 10 минут.
Четвёртое задание отвечает за обновление переменных, которые используются 2 и 3 заданиями. Оно просматривает все матчи, и как только оно определяет, что закончился первый/второй тайм, то она добавляет соответствующий матч для просмотра 2/3 заданием. Это задание выполняется 1 раз в 5 минут.