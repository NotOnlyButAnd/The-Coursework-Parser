170
ПРИМЕНЕНИЕ МЕТОДОВ ИНТЕЛЛЕКТУАЛЬНОГО АНАЛИЗА ДАННЫХ ДЛЯ ЗАДАЧ МЕДИЦИНСКОЙ ДИАГНОСТИКИ
2 Имплементация методов классификации 
2.2. Метод k ближайших соседей 
----------
Метод k ближайших соседей реализован в файле knn.py в виде класса KNNClassifier с конструктором __init__(k, distance_func), методами fit(X, y), predict(X), aggregate(neighbors_targets), _predict_x(x).
В конструктор передается параметр k – количество ближайших соседей (по умолчанию k=5), и параметр distance_func – используемая функция расстояния для вычисления расстояния между двумя объектами (по умолчанию евклидова метрика).
В метод fit передаются данные X и их метки y. Они сохраняются в полях класса.
Метод predict принимает список объектов X, которые нужно классифицировать, а возвращает список их меток. Для каждого объекта x из X вызывается метод _predict_x(x), который возвращает метку класса для этого объекта.
Метод _predict_x(x) работает следующим образом:
1)  Формируется список distance, i-ый элемент которого равен расстоянию между i-ым объектом в X и объектом x.
2)  Формируется список neighbours, элементами которого являются пары {расстояние, метка} для каждого объекта из X и каждой метки из y.
3)   Формируется список neighbors_targets, элементами которого являются метки k ближайших соседей объекта x.
4)  Вызывается функция aggregate(neighbors_targets), которая возвращает самую часто встречающуюся метку. Если таких меток несколько, то возвращается любая из них.