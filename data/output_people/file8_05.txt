163
ОПТИМИЗАЦИЯ ИСПОЛЬЗОВАНИЯ МОБИЛЬНОГО ТРАФИКА В ОС ANDROID
3 Разработка программы 
3.1 Реализация скачивания 
----------
Для загрузки аудиозаписей использовался класс DownloadManager [1]. Он очень удобен в использовании, так как достаточно указать ссылку на скачивание файла, путь к папке, в которую будет идти загрузка, тип файла и его будущее имя. Кроме того, класс позволяет добавлять оповещения о статусе загрузки.
На рисунке 2 показана схема работы класса DownloadManager.
Рисунок 2 – схема работы DownloadManager
После запуска скачивания загрузчик проверяет наличие в очереди других загружающихся файлов и, если такие есть, становится в очередь загрузки и остается в состоянии бездействия до тех пор, пока не придет его очередь. Далее происходит процедура инициализации, где программа устанавливает связь с сервером и получает информацию о будущем местоположении файла на устройстве. Затем начинается загрузка, которая может быть поставлена на паузу или остановлена пользователем. По окончании загрузки процесс скачивания завершается.
Таким образом, программа позволяет скачивать аудиозапись для дальнейшего прослушивания в off-line режиме, что значительно экономит мобильный трафик. Функции паузы и возобновления загрузки служат для обеспечения удобства загрузки.
Код программы с реализацией алгоритма скачивания находится в приложении А.