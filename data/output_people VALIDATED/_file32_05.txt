743
КЛАССИФИКАЦИЯ МУЗЫКАЛЬНЫХ КОМПОЗИЦИЙ ПО ИСПОЛНИТЕЛЯМ НА ОСНОВЕ МАШИННОГО ОБУЧЕНИЯ
1 Обзор методологий, применяемых для решения задач классификации 
1.4 Мел-частотные кепстральные коэффициенты 
----------
Для задач распознавания речи и звуковых сигналов используется метод, основанный на измерении скорости изменения спектральных характеристик сигнала, которые также называются мел-частотными кепстральными коэффициентами (MFCC). Эти коэффициенты – представление энергии сигнала в виде особого спектра, из которого путём различных фильтраций и преобразований удалены незначительные для человеческого уха компоненты и шумы. Спектр проецируется на так называемую мел-шкалу. Изначально сигнал делится на пересекающиеся отрезки по 20-40 мс (предполагается, что на этих отрезках частоты сигнала не меняются слишком сильно) на которых рассчитываются MFCC. Подобное представление сохраняет волновую «природу» сигнала и позволяет выделить наиболее значимые для человеческого уха частоты. К тому же, для каждого сигнала расположение данных коэффициентов на мел-шкале уникально, что позволяет использовать этот мел-частотный спектр в задачах распознавания речи и классификации музыкальных композиций в качестве важной характеристики каждого рассматриваемого сигнала в процессе обучения классификатора.
Вычисление мел-частотных кепстральных коэффициентов включает в себя следующие шаги [5]:
1)  Необходимо разделить исходный сигнал на кадры. Их размер обычно выбирается в диапазоне от 10 до 40 мс. Кадры накладываются друг на друга. В данном случае выберем длину кадра, например, 10мс, а наложение – 5мс. Так как в основном мел-кепстральные коэффициенты используются в выделении фонем в задачах автоматического распознавания речи, в качестве примера возьмём график временного представления слова «один», изображённый на рисунке 1.
Рисунок 1 – График зависимости амплитуды сигнала от времени для слова «один» (вертикальная ось – частота, горизонтальная – время в секундах).
2)  Полагаем, что звуковой сигнал конечен и не является периодическим, поэтому из-за разрывов на его концах, когда применяется преобразование Фурье, может произойти так называемый эффект утечки. В дискретной области так называют эффекты, связанные с искажениями в Фурье анализе, вызванные конечностью выборки. В случае периодического дискретного процесса этих эффектов удается избежать, если специальным образом выбирать шаг дискретизации и длину временного ряда. То есть, можно контролировать «ширину» этой утечки или, концентрируя её вокруг главной частоты (сильно “размывается” спектр, зато не мешает соседним частотам), или, растягивая её на бесконечности (но в этом случае размытие пиков уменьшается, а «шум» сильно растёт и вследствие этого растёт погрешность измерения амплитуды отдельных частот). Как правило, чтобы снизить влияние эффекта утечки на результат, к каждому кадру применяется оконная функция (весовая функция). Часто «конечный» сигнал, используемый для преобразования Фурье, в реальности является частью возможно бесконечного сигнала, такого, как синусоида, например. В этой ситуации применяют дополнение конечного отрезка нулями: считают, что исходный сигнал имеет бесконечно большую длину, но затем умножается на некоторую взвешивающую функцию — “окно”, обращающуюся в ноль вне доступного для измерения отрезка. В простейших случаях роль «окна» играет прямоугольная функция, с помощью которой мы, по сути, дополняем отрезок слева и справа бесконечным количеством нулей. В данном случае используем оконную функцию Хемминга:
w(n) = 0.54 – 0.46cos(2)                             (4)
3)  К каждому кадру применяется преобразование Фурье, получая тем самым спектр сигнала.  Далее вычисляется периодограмма – оценка спектральной плотности мощности сигнала:
Pi (k) = |Yi(k)|2/N                                                (5)
4)  Полученное представление сигнала в частотной области разбивают на диапазоны с помощью блока треугольных пересекающихся фильтров, расположенных наиболее плотно в области низких частот. Границы фильтров рассчитывают в мел-шкале. Данная шкала является результатом исследований по способности человеческого уха к восприятию звуков на различных частотах. Количество таких фильтров - 26. Для расчёта фильтров обычно выбираются верхняя и нижняя частоты, а затем осуществляется переход от частотной шкалы к мел-шкале по формуле (6):
M(f) = 1127*ln(1+f/700)                                       (6)
Между полученными значениями на мел-шкале выбираются точки, расположенные линейно, как правило, для 26 фильтров — 28 точек. После этого переход обратно в частотную шкалу осуществляется по обратной формуле 7:
F(m) = 700(exp(m/1125) - 1)	                           (7)
Рисунок 2 – График частотной шкалы
Из графика видно, что окна сжимаются в большей степени в области низких частот (рисунок 2). Далее простым перемножением векторов спектра сигнала и оконной функции находится энергия сигнала, которая попадает в каждое из анализируемых окон. Получаем некоторый набор коэффициентов. Но это ещё не мел-кепстральные коэффициенты, которые мы хотим найти. Полученные значения энергии сигнала возводятся в квадрат и логарифмируются, после чего применяется дискретное косинусное преобразование. В итоге, имеем 26 коэффициентов для каждого кадра (окна) — это и есть мел-частотные кепстральные коэффициенты. В задачах распознавания речи обычно используются первые 13-16 из них, как наиболее информативные для речевого сигнала.
В результате последовательность коэффициентов выглядит так, как показано на рисунке 3.
Рисунок 3 – График расположения спектральных частотных коэффициентов на мел-шкале
Таким образом, мы получили небольшой набор значений, преимущество которого при распознавании звукового и речевого сигнала в том, что достаточно брать около 16 коэффициентов на каждый кадр вместо сотен или тысяч, как было бы в случае обычного преобразования Фурье. Экспериментальным путем выяснено, что для выделения этих коэффициентов в песнях лучше брать по 30-40 компонент.