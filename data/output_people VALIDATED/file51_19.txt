470
ИССЛЕДОВАНИЯ АЛГОРИТМОВ КОЛЛАБОРАТИВНОЙ ФИЛЬТРАЦИИ И РАЗРАБОТКА РАСШИРЯЕМОЙ РЕКОМЕНДАТЕЛЬНОЙ СИСТЕМЫ
3 Практическая реализация рекомендательной системы с неявной обратной связью через матричную факторизацию 
3.6 Пример выдачи рекомендаций 
----------
Теперь получена рекомендательная система, что она имеет более точное предсказание чем рекомендация самых популярных товаров. AUC равный 0,87 означает, что система рекомендует пользователю такие товары, которые он бы на самом деле купил при обучении на тестовом множестве намного чаще, чем те, с которыми он никогда не взаимодействовал. Чтобы увидеть на примере, как это работает, рассмотрим рекомендации для конкретного пользователя и субъективно решим, если ли в этих рекомендациях какой-то смысл.
Для начала необходимо реализовать функцию, которая будет возвращать для пользователя товары, с которыми он уже взаимодействовал. Для этих целей создаем массивы клиентов и товаров, которые были сделали заранее, что показано на рисунке 17.
Рисунок 17 – Инициализация ID клиентов и товаров
Теперь можно создать функцию, которая будет возвращать список товаров с которыми пользователь уже взаимодействовал (рисунок 18).
Рисунок 18 – Получение взаимодействующих с клиентом товаров
Необходимо искать их по ID клиента (рисунок 19). Глядя на список клиентов:
Рисунок 19 – Список ID клиентов
Мы видим, что первый в списке клиентов имеет ID равный 12346.
Рассмотрим его покупки из обучающего набора (рисунок 20).
Рисунок 20 – Получение товаров, которые взаимодействовали с текущим клиентом
Мы видим, что клиент приобрел MEDIUM CERAMIC TOP STORAGE JAR.
Теперь зная о покупках пользователя, реализуем функцию, которая на основе предыдущих предпочтений представит пользователю рекомендации. Для написания такой функции импортируем также MinMaxScaler из пакета scikitlearn (рисунок 21), что упростит нам ее описание.
Рисунок 21 – Получение рекомендаций
По сути, эта функция будет возвращать N самых больших скалярных произведений между конкретным пользователем и всеми векторами товаров. Предметы, которые уже были приобрели конкретным пользователем больше ему не рекомендуются. Будем возвращать по умолчанию 10 товаров и рассмотрим, что рекомендательная система порекомендовала для конкретного клиента с ID 123456 (рисунок 22).
.
Рисунок 22 – Полученные рекомендации
Эти рекомендации кажутся довольно хорошими. Помните, что система рекомендации не имеет никакого реального понимания того, что из себя представляет керамическая фляга. Все, что она знает, так это историю покупок. Система установила, что люди, купив банку средних размеров также могут купить баночки разного размера. Я лично был поражен тем, насколько хорошо такая система подходит к подобной модели шопинга. Теперь рассмотрим другого пользователя с ID = 12353, который не сделал большого количества покупок (рисунок 23).
Рисунок 23 – Покупки пользователя с ID = 12353
По покупкам этого пользователя кажется, что он печет пирожки. Рассмотрим какие товары рекомендательная система предложит этому человеку (рисунок 24).
Рисунок 24 – Полученные рекомендации
Система выдала выборку на тему тортов вместе с керамическими изделиями. Опять же, эти рекомендации кажутся очень впечатляющими, так как система не понимает содержание рекомендаций. Теперь рассмотрим рекомендации для  ID = 12361 (рисунок 25).
Рисунок 25 – Приобретенные товары текущим клиентом
Этот клиент покупал продукты, пригодные для обеда. Теперь давайте рассмотрим, что выдала рекомендательная система (Рисунок 26).
Рисунок 26 – Полученные рекомендации для данного пользователя
Опять же, рекомендательная система удивительно неплохо справилась.
Много товаров, связанных с едой, представлено в этом списке рекомендаций.